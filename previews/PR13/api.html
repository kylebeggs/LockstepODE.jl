<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API Reference | LockstepODE.jl</title>
    <meta name="description" content="Documentation for LockstepODE.jl">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/LockstepODE.jl/previews/PR13/assets/style.CdFnNi-h.css" as="style">
    <link rel="preload stylesheet" href="/LockstepODE.jl/previews/PR13/vp-icons.css" as="style">
    
    <script type="module" src="/LockstepODE.jl/previews/PR13/assets/app.C3ppRD_-.js"></script>
    <link rel="preload" href="/LockstepODE.jl/previews/PR13/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/LockstepODE.jl/previews/PR13/assets/chunks/theme.DB-X-jIt.js">
    <link rel="modulepreload" href="/LockstepODE.jl/previews/PR13/assets/chunks/framework.DFWmPaxL.js">
    <link rel="modulepreload" href="/LockstepODE.jl/previews/PR13/assets/api.md.B4QauGHd.lean.js">
    <script src="/LockstepODE.jl/versions.js"></script>
    <script src="/LockstepODE.jl/previews/PR13/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/LockstepODE.jl/previews/PR13/" data-v-0f4f798b><!--[--><!--]--><!----><span data-v-0f4f798b>LockstepODE.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/LockstepODE.jl/previews/PR13/index" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/LockstepODE.jl/previews/PR13/getting_started" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Getting Started</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Examples</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/LockstepODE.jl/previews/PR13/examples/basic_usage" data-v-acbfed09><!--[--><span data-v-acbfed09>Basic Usage</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/LockstepODE.jl/previews/PR13/examples/callbacks" data-v-acbfed09><!--[--><span data-v-acbfed09>Callbacks</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/LockstepODE.jl/previews/PR13/examples/advanced_configuration" data-v-acbfed09><!--[--><span data-v-acbfed09>Advanced Configuration</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/LockstepODE.jl/previews/PR13/api" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>API Reference</span><!--]--></a><!--]--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/kylebeggs/LockstepODE.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/kylebeggs/LockstepODE.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/LockstepODE.jl/previews/PR13/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Home</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/LockstepODE.jl/previews/PR13/getting_started" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Getting Started</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Examples</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/LockstepODE.jl/previews/PR13/examples/basic_usage" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Basic Usage</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/LockstepODE.jl/previews/PR13/examples/callbacks" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Callbacks</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/LockstepODE.jl/previews/PR13/examples/advanced_configuration" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Advanced Configuration</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 has-active" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/LockstepODE.jl/previews/PR13/api" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>API Reference</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _LockstepODE_jl_previews_PR13_api" data-v-83890dd9><div><h1 id="API-Reference" tabindex="-1">API Reference <a class="header-anchor" href="#API-Reference" aria-label="Permalink to &quot;API Reference {#API-Reference}&quot;">​</a></h1><h2 id="Execution-Modes" tabindex="-1">Execution Modes <a class="header-anchor" href="#Execution-Modes" aria-label="Permalink to &quot;Execution Modes {#Execution-Modes}&quot;">​</a></h2><details class="jldocstring custom-block" open><summary><a id="LockstepODE.LockstepMode" href="#LockstepODE.LockstepMode"><span class="jlbinding">LockstepODE.LockstepMode</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LockstepMode</span></span></code></pre></div><p>Abstract type for lockstep execution modes.</p><p>Subtypes:</p><ul><li><p><code>Ensemble</code>: N independent ODE integrators, synchronized via lockstep time tracking</p></li><li><p><code>Batched</code>: Single ODE integrator with batched state vector, parallel RHS evaluation</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L14-L22" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="LockstepODE.Ensemble" href="#LockstepODE.Ensemble"><span class="jlbinding">LockstepODE.Ensemble</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Ensemble </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepMode</span></span></code></pre></div><p>N independent ODE integrators mode.</p><p>Each ODE has its own integrator with potentially different adaptive timesteps. Synchronization is via lockstep time tracking (minimum time across all integrators).</p><p>Best for:</p><ul><li><p>Per-ODE control and introspection</p></li><li><p>Complex callbacks per ODE</p></li><li><p>ModelingToolkit integration</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L25-L37" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="LockstepODE.Batched" href="#LockstepODE.Batched"><span class="jlbinding">LockstepODE.Batched</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Batched </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepMode</span></span></code></pre></div><p>Single batched ODE integrator mode.</p><p>All ODEs share a single integrator with one flat state vector. RHS evaluation is parallelized across ODEs.</p><p>Best for:</p><ul><li><p>Large N (many ODEs)</p></li><li><p>GPU acceleration</p></li><li><p>Maximum performance when per-ODE control is not needed</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L40-L52" target="_blank" rel="noreferrer">source</a><!--]--></span></details><h2 id="Memory-Ordering" tabindex="-1">Memory Ordering <a class="header-anchor" href="#Memory-Ordering" aria-label="Permalink to &quot;Memory Ordering {#Memory-Ordering}&quot;">​</a></h2><details class="jldocstring custom-block" open><summary><a id="LockstepODE.MemoryOrdering" href="#LockstepODE.MemoryOrdering"><span class="jlbinding">LockstepODE.MemoryOrdering</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MemoryOrdering</span></span></code></pre></div><p>Abstract type for batched mode memory layouts.</p><p>Subtypes:</p><ul><li><p><code>PerODE</code>: Each ODE&#39;s state stored contiguously (default)</p></li><li><p><code>PerIndex</code>: Same variable index across ODEs stored contiguously</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L55-L63" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="LockstepODE.PerODE" href="#LockstepODE.PerODE"><span class="jlbinding">LockstepODE.PerODE</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PerODE </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MemoryOrdering</span></span></code></pre></div><p>Memory layout where each ODE&#39;s state is stored contiguously.</p><p>For 2 ODEs with 3 variables each: <code>[u1_ode1, u2_ode1, u3_ode1, u1_ode2, u2_ode2, u3_ode2]</code></p><p>This is generally the best layout for most use cases.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L66-L75" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="LockstepODE.PerIndex" href="#LockstepODE.PerIndex"><span class="jlbinding">LockstepODE.PerIndex</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PerIndex </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MemoryOrdering</span></span></code></pre></div><p>Memory layout where same variable index is stored contiguously across ODEs.</p><p>For 2 ODEs with 3 variables each: <code>[u1_ode1, u1_ode2, u2_ode1, u2_ode2, u3_ode1, u3_ode2]</code></p><p>May provide better cache locality for operations that access the same variable across all ODEs.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L78-L88" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="LockstepODE.BatchedOpts" href="#LockstepODE.BatchedOpts"><span class="jlbinding">LockstepODE.BatchedOpts</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BatchedOpts{O</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MemoryOrdering</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Options for Batched mode execution.</p><p><strong>Fields</strong></p><ul><li><p><code>ordering::O</code>: Memory layout (PerODE or PerIndex)</p></li><li><p><code>internal_threading::Bool</code>: Enable CPU threading for RHS evaluation</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L95-L103" target="_blank" rel="noreferrer">source</a><!--]--></span></details><h2 id="Core-Types" tabindex="-1">Core Types <a class="header-anchor" href="#Core-Types" aria-label="Permalink to &quot;Core Types {#Core-Types}&quot;">​</a></h2><details class="jldocstring custom-block" open><summary><a id="LockstepODE.LockstepFunction" href="#LockstepODE.LockstepFunction"><span class="jlbinding">LockstepODE.LockstepFunction</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LockstepFunction{F, C}</span></span></code></pre></div><p>Coordinates solving N independent ODEs in parallel.</p><p><strong>Fields</strong></p><ul><li><p><code>f::F</code>: ODE function with signature <code>f(du, u, p, t)</code></p></li><li><p><code>num_odes::Int</code>: Number of independent ODEs</p></li><li><p><code>ode_size::Int</code>: Size of each ODE&#39;s state vector</p></li><li><p><code>callbacks::C</code>: Per-ODE callbacks (nothing, single, or Vector)</p></li></ul><p><strong>Constructor</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, ode_size, num_odes; callbacks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> lorenz!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(du, u, p, t)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    σ, ρ, β </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> p</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    du[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    du[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ρ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    du[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> β</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lorenz!, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L117-L144" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="LockstepODE.LockstepProblem" href="#LockstepODE.LockstepProblem"><span class="jlbinding">LockstepODE.LockstepProblem</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LockstepProblem{M</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepMode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, LF, U, T, P, Opts}</span></span></code></pre></div><p>Problem type for batched ODE solving with mode-specific behavior.</p><p><strong>Type Parameters</strong></p><ul><li><p><code>M&lt;:LockstepMode</code>: Execution mode (Ensemble or Batched)</p></li><li><p><code>LF</code>: LockstepFunction type</p></li><li><p><code>U</code>: Initial condition element type</p></li><li><p><code>T</code>: Time type</p></li><li><p><code>P</code>: Parameter element type</p></li><li><p><code>Opts</code>: Mode-specific options type (Nothing for Ensemble, BatchedOpts for Batched)</p></li></ul><p><strong>Fields</strong></p><ul><li><p><code>lf::LF</code>: LockstepFunction coordinator</p></li><li><p><code>u0s::Vector{U}</code>: Initial conditions (one per ODE, normalized)</p></li><li><p><code>tspan::Tuple{T, T}</code>: Time span</p></li><li><p><code>ps::Vector{P}</code>: Parameters (one per ODE, normalized)</p></li><li><p><code>opts::Opts</code>: Mode-specific options</p></li></ul><p><strong>Constructors</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Default: Batched mode (best performance)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, tspan, p</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Explicit Batched mode with options</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepProblem{Batched}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, tspan, p</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; ordering</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PerODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), internal_threading</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Ensemble mode (independent timesteps per ODE)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepProblem{Ensemble}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, tspan, p</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> lorenz!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(du, u, p, t)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    σ, ρ, β </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> p</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    du[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    du[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ρ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    du[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> β</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lorenz!, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u0s </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Batched mode (default) - single batched integrator, GPU-compatible</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob_b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), p)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol_b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob_b, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Ensemble mode - N independent integrators with adaptive timesteps</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob_e </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepProblem{Ensemble}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), p)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol_e </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob_e, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/problem.jl#L8-L61" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="LockstepODE.LockstepSolution" href="#LockstepODE.LockstepSolution"><span class="jlbinding">LockstepODE.LockstepSolution</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LockstepSolution{S}</span></span></code></pre></div><p>Combined solution from N independent ODEs.</p><p><strong>Fields</strong></p><ul><li><p><code>solutions::Vector{S}</code>: Individual ODESolutions (one per ODE)</p></li><li><p><code>retcode::ReturnCode.T</code>: Overall return code</p></li></ul><p><strong>Accessors</strong></p><ul><li><p><code>sol[i]</code>: Get i-th ODE&#39;s solution</p></li><li><p><code>length(sol)</code>: Number of ODEs</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L182-L194" target="_blank" rel="noreferrer">source</a><!--]--></span></details><h2 id="Integrator-Types" tabindex="-1">Integrator Types <a class="header-anchor" href="#Integrator-Types" aria-label="Permalink to &quot;Integrator Types {#Integrator-Types}&quot;">​</a></h2><details class="jldocstring custom-block" open><summary><a id="LockstepODE.AbstractLockstepIntegrator" href="#LockstepODE.AbstractLockstepIntegrator"><span class="jlbinding">LockstepODE.AbstractLockstepIntegrator</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AbstractLockstepIntegrator{M}</span></span></code></pre></div><p>Abstract type for lockstep integrators, parametric on mode.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L18-L22" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="LockstepODE.EnsembleLockstepIntegrator" href="#LockstepODE.EnsembleLockstepIntegrator"><span class="jlbinding">LockstepODE.EnsembleLockstepIntegrator</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EnsembleLockstepIntegrator{A, I, LF, T}</span></span></code></pre></div><p>Unified integrator wrapping N individual OrdinaryDiffEq integrators. Implements CommonSolve step!/solve!/reinit! interface.</p><p><strong>Fields</strong></p><ul><li><p><code>integrators</code>: Vector of N individual ODE integrators</p></li><li><p><code>lf</code>: Reference to LockstepFunction</p></li><li><p><code>alg</code>: ODE algorithm</p></li><li><p><code>t</code>: Current lockstep time (minimum of all integrator times)</p></li><li><p><code>tspan</code>: Original time span</p></li><li><p><code>tdir</code>: Time direction (+1 or -1)</p></li><li><p><code>retcode</code>: Overall return code</p></li></ul><p><strong>Accessors</strong></p><ul><li><p><code>integ[i]</code>: Returns i-th underlying OrdinaryDiffEq integrator</p></li><li><p><code>integ.u</code>: Returns vector of current states <code>[integ[1].u, ...]</code></p></li><li><p><code>integ.t</code>: Returns current lockstep time</p></li><li><p><code>length(integ)</code>: Number of ODEs</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L32-L52" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="LockstepODE.BatchedLockstepIntegrator" href="#LockstepODE.BatchedLockstepIntegrator"><span class="jlbinding">LockstepODE.BatchedLockstepIntegrator</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BatchedLockstepIntegrator{I, LF, BF, Opts}</span></span></code></pre></div><p>Wrapper around a single OrdinaryDiffEq integrator with batched state. Provides uniform interface for Batched mode solving.</p><p><strong>Fields</strong></p><ul><li><p><code>integrator</code>: Single OrdinaryDiffEq integrator with batched state</p></li><li><p><code>lf</code>: Reference to LockstepFunction</p></li><li><p><code>bf</code>: BatchedFunction used for RHS evaluation</p></li><li><p><code>opts</code>: BatchedOpts configuration</p></li></ul><p><strong>Accessors</strong></p><ul><li><p><code>integ[i]</code>: Returns SubIntegrator for i-th ODE</p></li><li><p><code>integ.u</code>: Returns vector of state views <code>[view(u, idxs_1), ...]</code></p></li><li><p><code>integ.t</code>: Returns current time</p></li><li><p><code>length(integ)</code>: Number of ODEs</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L67-L84" target="_blank" rel="noreferrer">source</a><!--]--></span></details><h2 id="CommonSolve-Interface" tabindex="-1">CommonSolve Interface <a class="header-anchor" href="#CommonSolve-Interface" aria-label="Permalink to &quot;CommonSolve Interface {#CommonSolve-Interface}&quot;">​</a></h2><details class="jldocstring custom-block" open><summary><a id="CommonSolve.init" href="#CommonSolve.init"><span class="jlbinding">CommonSolve.init</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepProblem{Ensemble}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, alg; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Initialize an EnsembleLockstepIntegrator for Ensemble mode.</p><p>Creates N independent ODE integrators that can be stepped manually or solved to completion.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepProblem{Ensemble}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), p)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Explicit Ensemble mode</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">integ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/commonsolve.jl#L18-L33" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepProblem{Batched}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, alg; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Initialize a BatchedLockstepIntegrator for Batched mode.</p><p>Creates a single ODE integrator with batched state vector. RHS evaluation is parallelized across ODEs. Supports GPU arrays.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepProblem{Batched}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), p)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">integ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/commonsolve.jl#L143-L158" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="CommonSolve.solve" href="#CommonSolve.solve"><span class="jlbinding">CommonSolve.solve</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepProblem{Ensemble}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, alg; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Solve the Ensemble mode problem to completion.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), p)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/commonsolve.jl#L74-L84" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepProblem{Batched}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, alg; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Solve the Batched mode problem to completion.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepProblem{Batched}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), p)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/commonsolve.jl#L200-L210" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="CommonSolve.solve!" href="#CommonSolve.solve!"><span class="jlbinding">CommonSolve.solve!</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">solve!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnsembleLockstepIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Solve the Ensemble integrator to completion.</p><p>Solves all N ODE integrators in parallel independently.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">integ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Optional manual stepping</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Complete the solve</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/commonsolve.jl#L98-L111" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">solve!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchedLockstepIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Solve the Batched integrator to completion.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">integ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Optional manual stepping</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Complete the solve</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/commonsolve.jl#L224-L235" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="CommonSolve.step!" href="#CommonSolve.step!"><span class="jlbinding">CommonSolve.step!</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnsembleLockstepIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Advance all integrators by one adaptive step. Updates <code>integ.t</code> to the minimum time across all integrators.</p><p>Note: Retcode is updated lazily via <code>update_retcode!</code> for performance. Call <code>update_retcode!(integ)</code> explicitly if immediate failure detection is needed.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L198-L206" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnsembleLockstepIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dt, stop_at_tdt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Advance all integrators by time <code>dt</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>dt</code>: Time increment</p></li><li><p><code>stop_at_tdt</code>: If <code>true</code>, step exactly to <code>t + dt</code>. If <code>false</code>, step may overshoot.</p></li></ul><p>Note: Retcode is updated lazily via <code>update_retcode!</code> for performance.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L218-L228" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchedLockstepIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Advance the batched integrator by one step.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L266-L270" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchedLockstepIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dt, stop_at_tdt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Advance the batched integrator by time <code>dt</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L276-L280" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="SciMLBase.reinit!" href="#SciMLBase.reinit!"><span class="jlbinding">SciMLBase.reinit!</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reinit!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnsembleLockstepIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, u0s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; t0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, tf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, erase_sol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Reinitialize the Ensemble integrator, optionally with new initial conditions.</p><p><strong>Arguments</strong></p><ul><li><p><code>u0s</code>: New initial conditions (vector of vectors, single vector, or <code>nothing</code> to keep current)</p></li><li><p><code>t0</code>: New initial time (default: original t0)</p></li><li><p><code>tf</code>: New final time (default: original tf)</p></li><li><p><code>erase_sol</code>: Whether to erase accumulated solution data</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L290-L300" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reinit!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchedLockstepIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, u0s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; t0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, tf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, erase_sol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Reinitialize the Batched integrator, optionally with new initial conditions.</p><p><strong>Arguments</strong></p><ul><li><p><code>u0s</code>: New initial conditions (vector of vectors, single vector, or <code>nothing</code> to keep current)</p></li><li><p><code>t0</code>: New initial time (default: original t0)</p></li><li><p><code>tf</code>: New final time (default: original tf)</p></li><li><p><code>erase_sol</code>: Whether to erase accumulated solution data</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L344-L354" target="_blank" rel="noreferrer">source</a><!--]--></span></details><h2 id="Solution-Utilities" tabindex="-1">Solution Utilities <a class="header-anchor" href="#Solution-Utilities" aria-label="Permalink to &quot;Solution Utilities {#Solution-Utilities}&quot;">​</a></h2><details class="jldocstring custom-block" open><summary><a id="LockstepODE.extract_solutions" href="#LockstepODE.extract_solutions"><span class="jlbinding">LockstepODE.extract_solutions</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">extract_solutions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, sol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepSolution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Extract individual ODE solutions as a vector.</p><p>This is a convenience function for compatibility with the v1 API. With LockstepSolution, you can also just use <code>sol.solutions</code> or iterate directly.</p><p><strong>Returns</strong></p><p>Vector of individual ODESolution objects.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f!, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, tspan, p)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">individual_sols </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> extract_solutions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, sol)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (i, s) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(individual_sols)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ODE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> final state: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$(s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">u[end])</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/solution.jl#L170-L192" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="LockstepODE.extract_at_time" href="#LockstepODE.extract_at_time"><span class="jlbinding">LockstepODE.extract_at_time</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">extract_at_time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepSolution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Real</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Extract all ODE states at a specific time (with interpolation).</p><p><strong>Returns</strong></p><p>Vector of state vectors, one per ODE.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states_at_5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> extract_at_time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sol, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (i, state) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(states_at_5)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ODE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> at t=5: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/solution.jl#L197-L212" target="_blank" rel="noreferrer">source</a><!--]--></span></details><h2 id="Batched-Mode-Internals" tabindex="-1">Batched Mode Internals <a class="header-anchor" href="#Batched-Mode-Internals" aria-label="Permalink to &quot;Batched Mode Internals {#Batched-Mode-Internals}&quot;">​</a></h2><details class="jldocstring custom-block" open><summary><a id="LockstepODE.BatchedFunction" href="#LockstepODE.BatchedFunction"><span class="jlbinding">LockstepODE.BatchedFunction</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BatchedFunction{O</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MemoryOrdering</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, F, C}</span></span></code></pre></div><p>Callable wrapper for batched ODE solving with a LockstepFunction.</p><p>Wraps a LockstepFunction with batched-specific options (memory ordering, threading) and provides the callable interface <code>(du, u, p, t)</code> for OrdinaryDiffEq.jl.</p><p><strong>Fields</strong></p><ul><li><p><code>lf::LockstepFunction{F,C}</code>: The underlying LockstepFunction</p></li><li><p><code>ordering::O</code>: Memory layout (PerODE or PerIndex)</p></li><li><p><code>internal_threading::Bool</code>: Enable CPU threading for RHS evaluation</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lorenz!, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BatchedFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PerODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Now bf can be used with ODEProblem</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u0_batched </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> vcat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ODEProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bf, u0_batched, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), p)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/batched.jl#L14-L36" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="LockstepODE.SubIntegrator" href="#LockstepODE.SubIntegrator"><span class="jlbinding">LockstepODE.SubIntegrator</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SubIntegrator{I, BF, U, P}</span></span></code></pre></div><p>Lightweight wrapper providing a per-ODE view of the batched integrator state.</p><p>Used by the callback system to give per-ODE callbacks access to only their ODE&#39;s state while maintaining the ability to modify the full integrator.</p><p><strong>Fields</strong></p><ul><li><p><code>parent::I</code>: The full OrdinaryDiffEq integrator</p></li><li><p><code>bf::BF</code>: The BatchedFunction containing metadata</p></li><li><p><code>ode_idx::Int</code>: Index of the ODE this sub-integrator represents</p></li><li><p><code>u::U</code>: View of the state for this ODE only</p></li><li><p><code>p::P</code>: Parameters for this ODE</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/batched.jl#L151-L165" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="LockstepODE.BatchedSubSolution" href="#LockstepODE.BatchedSubSolution"><span class="jlbinding">LockstepODE.BatchedSubSolution</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BatchedSubSolution{S, BF}</span></span></code></pre></div><p>Wrapper providing per-ODE solution access with interpolation for Batched mode.</p><p>When <code>sol = solve(prob, alg)</code> is called in Batched mode, <code>sol[i]</code> returns a <code>BatchedSubSolution</code> that provides:</p><ul><li><p><code>sol[i](t)</code>: Interpolate state at time <code>t</code></p></li><li><p><code>sol[i].u</code>: Time series of states (cached on first access)</p></li><li><p><code>sol[i].t</code>: Time points</p></li></ul><p><strong>Fields</strong></p><ul><li><p><code>parent::S</code>: The full batched ODESolution</p></li><li><p><code>bf::BF</code>: BatchedFunction for index calculations</p></li><li><p><code>ode_idx::Int</code>: Which ODE this represents</p></li><li><p><code>_u_cache::Vector</code>: Cached time series (populated on first .u access)</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/solution.jl#L12-L28" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="LockstepODE._get_idxs" href="#LockstepODE._get_idxs"><span class="jlbinding">LockstepODE._get_idxs</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">_get_idxs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchedFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UnitRange</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">StepRange</span></span></code></pre></div><p>Get the indices for the i-th ODE&#39;s state in the batched state vector.</p><p>Dispatches on memory ordering:</p><ul><li><p>PerODE: Returns contiguous range <code>((i-1)*M+1):(i*M)</code></p></li><li><p>PerIndex: Returns strided range <code>i:N:((M-1)*N+i)</code></p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/batched.jl#L66-L74" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="LockstepODE.ode_kernel!" href="#LockstepODE.ode_kernel!"><span class="jlbinding">LockstepODE.ode_kernel!</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ode_kernel!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i, bf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchedFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, du, u, p, t)</span></span></code></pre></div><p>Evaluate the i-th ODE&#39;s RHS within the batched system.</p><p>This is the core kernel called for each ODE in the batch. Marked <code>@inline</code> for use in GPU extensions via KernelAbstractions.jl.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/batched.jl#L108-L115" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="LockstepODE.create_lockstep_callbacks" href="#LockstepODE.create_lockstep_callbacks"><span class="jlbinding">LockstepODE.create_lockstep_callbacks</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">create_lockstep_callbacks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchedFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Create wrapped callbacks for batched ODE solving.</p><p>Takes a BatchedFunction with per-ODE callbacks stored in its LockstepFunction and returns callbacks that dispatch to SubIntegrators for each ODE.</p><p>Returns <code>nothing</code> if no callbacks are stored.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/batched.jl#L205-L214" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="LockstepODE.batch_u0s" href="#LockstepODE.batch_u0s"><span class="jlbinding">LockstepODE.batch_u0s</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">batch_u0s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u0s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vector{&lt;:AbstractVector}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PerODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Concatenate per-ODE initial conditions into PerODE layout. Layout: [u1_ode1, u2_ode1, ..., u1_ode2, u2_ode2, ...]</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/batched.jl#L281-L286" target="_blank" rel="noreferrer">source</a><!--]--></span><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">batch_u0s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u0s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vector{&lt;:AbstractVector}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PerIndex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Concatenate per-ODE initial conditions into PerIndex layout. Layout: [u1_ode1, u1_ode2, ..., u2_ode1, u2_ode2, ...]</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/batched.jl#L291-L296" target="_blank" rel="noreferrer">source</a><!--]--></span></details></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://https://github.com/kylebeggs/LockstepODE.jl/edit/main/docs/src/api.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/LockstepODE.jl/previews/PR13/examples/advanced_configuration" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>Advanced Configuration</span><!--]--></a></div><div class="pager" data-v-4f9813fa><!----></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br></p><p class="copyright" data-v-c970a860>© Copyright 2026.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api.md\":\"B4QauGHd\",\"examples_advanced_configuration.md\":\"BlAf9-XN\",\"examples_basic_usage.md\":\"BbWrjIXK\",\"examples_callbacks.md\":\"DsV-62KK\",\"getting_started.md\":\"LVGtFlEb\",\"index.md\":\"Cs3Ef3wk\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"LockstepODE.jl\",\"description\":\"Documentation for LockstepODE.jl\",\"base\":\"/LockstepODE.jl/previews/PR13/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Home\",\"link\":\"/index\"},{\"text\":\"Getting Started\",\"link\":\"/getting_started\"},{\"text\":\"Examples\",\"collapsed\":false,\"items\":[{\"text\":\"Basic Usage\",\"link\":\"/examples/basic_usage\"},{\"text\":\"Callbacks\",\"link\":\"/examples/callbacks\"},{\"text\":\"Advanced Configuration\",\"link\":\"/examples/advanced_configuration\"}]},{\"text\":\"API Reference\",\"link\":\"/api\"},{\"component\":\"VersionPicker\"}],\"sidebar\":[{\"text\":\"Home\",\"link\":\"/index\"},{\"text\":\"Getting Started\",\"link\":\"/getting_started\"},{\"text\":\"Examples\",\"collapsed\":false,\"items\":[{\"text\":\"Basic Usage\",\"link\":\"/examples/basic_usage\"},{\"text\":\"Callbacks\",\"link\":\"/examples/callbacks\"},{\"text\":\"Advanced Configuration\",\"link\":\"/examples/advanced_configuration\"}]},{\"text\":\"API Reference\",\"link\":\"/api\"}],\"editLink\":{\"pattern\":\"https://https://github.com/kylebeggs/LockstepODE.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/kylebeggs/LockstepODE.jl\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>\",\"copyright\":\"© Copyright 2026.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>