import{_ as p,C as k,c as h,o,j as i,a as e,aA as l,G as a,w as n}from"./chunks/framework.DFWmPaxL.js";const G=JSON.parse('{"title":"API Reference","description":"","frontmatter":{},"headers":[],"relativePath":"api.md","filePath":"api.md","lastUpdated":null}'),r={name:"api.md"},d={class:"jldocstring custom-block",open:""},g={class:"jldocstring custom-block",open:""},E={class:"jldocstring custom-block",open:""},c={class:"jldocstring custom-block",open:""},y={class:"jldocstring custom-block",open:""},u={class:"jldocstring custom-block",open:""},b={class:"jldocstring custom-block",open:""},F={class:"jldocstring custom-block",open:""},C={class:"jldocstring custom-block",open:""},m={class:"jldocstring custom-block",open:""},f={class:"jldocstring custom-block",open:""},_={class:"jldocstring custom-block",open:""},D={class:"jldocstring custom-block",open:""},v={class:"jldocstring custom-block",open:""},T={class:"jldocstring custom-block",open:""},j={class:"jldocstring custom-block",open:""},A={class:"jldocstring custom-block",open:""},B={class:"jldocstring custom-block",open:""},L={class:"jldocstring custom-block",open:""},O={class:"jldocstring custom-block",open:""},S={class:"jldocstring custom-block",open:""},x={class:"jldocstring custom-block",open:""},I={class:"jldocstring custom-block",open:""},P={class:"jldocstring custom-block",open:""},V={class:"jldocstring custom-block",open:""},R={class:"jldocstring custom-block",open:""},N={class:"jldocstring custom-block",open:""};function w(M,s,U,z,q,W){const t=k("Badge");return o(),h("div",null,[s[124]||(s[124]=i("h1",{id:"API-Reference",tabindex:"-1"},[e("API Reference "),i("a",{class:"header-anchor",href:"#API-Reference","aria-label":'Permalink to "API Reference {#API-Reference}"'},"​")],-1)),s[125]||(s[125]=i("h2",{id:"Execution-Modes",tabindex:"-1"},[e("Execution Modes "),i("a",{class:"header-anchor",href:"#Execution-Modes","aria-label":'Permalink to "Execution Modes {#Execution-Modes}"'},"​")],-1)),i("details",d,[i("summary",null,[s[0]||(s[0]=i("a",{id:"LockstepODE.LockstepMode",href:"#LockstepODE.LockstepMode"},[i("span",{class:"jlbinding"},"LockstepODE.LockstepMode")],-1)),s[1]||(s[1]=e()),a(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[3]||(s[3]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LockstepMode</span></span></code></pre></div><p>Abstract type for lockstep execution modes.</p><p>Subtypes:</p><ul><li><p><code>Ensemble</code>: N independent ODE integrators, synchronized via lockstep time tracking</p></li><li><p><code>Batched</code>: Single ODE integrator with batched state vector, parallel RHS evaluation</p></li></ul>',4)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[2]||(s[2]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L14-L22",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",g,[i("summary",null,[s[4]||(s[4]=i("a",{id:"LockstepODE.Ensemble",href:"#LockstepODE.Ensemble"},[i("span",{class:"jlbinding"},"LockstepODE.Ensemble")],-1)),s[5]||(s[5]=e()),a(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[7]||(s[7]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Ensemble </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepMode</span></span></code></pre></div><p>N independent ODE integrators mode.</p><p>Each ODE has its own integrator with potentially different adaptive timesteps. Synchronization is via lockstep time tracking (minimum time across all integrators).</p><p>Best for:</p><ul><li><p>Per-ODE control and introspection</p></li><li><p>Complex callbacks per ODE</p></li><li><p>ModelingToolkit integration</p></li></ul>',5)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[6]||(s[6]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L25-L37",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",E,[i("summary",null,[s[8]||(s[8]=i("a",{id:"LockstepODE.Batched",href:"#LockstepODE.Batched"},[i("span",{class:"jlbinding"},"LockstepODE.Batched")],-1)),s[9]||(s[9]=e()),a(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[11]||(s[11]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Batched </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepMode</span></span></code></pre></div><p>Single batched ODE integrator mode.</p><p>All ODEs share a single integrator with one flat state vector. RHS evaluation is parallelized across ODEs.</p><p>Best for:</p><ul><li><p>Large N (many ODEs)</p></li><li><p>GPU acceleration</p></li><li><p>Maximum performance when per-ODE control is not needed</p></li></ul>',5)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[10]||(s[10]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L40-L52",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[126]||(s[126]=i("h2",{id:"Memory-Ordering",tabindex:"-1"},[e("Memory Ordering "),i("a",{class:"header-anchor",href:"#Memory-Ordering","aria-label":'Permalink to "Memory Ordering {#Memory-Ordering}"'},"​")],-1)),i("details",c,[i("summary",null,[s[12]||(s[12]=i("a",{id:"LockstepODE.MemoryOrdering",href:"#LockstepODE.MemoryOrdering"},[i("span",{class:"jlbinding"},"LockstepODE.MemoryOrdering")],-1)),s[13]||(s[13]=e()),a(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[15]||(s[15]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MemoryOrdering</span></span></code></pre></div><p>Abstract type for batched mode memory layouts.</p><p>Subtypes:</p><ul><li><p><code>PerODE</code>: Each ODE&#39;s state stored contiguously (default)</p></li><li><p><code>PerIndex</code>: Same variable index across ODEs stored contiguously</p></li></ul>',4)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[14]||(s[14]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L55-L63",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",y,[i("summary",null,[s[16]||(s[16]=i("a",{id:"LockstepODE.PerODE",href:"#LockstepODE.PerODE"},[i("span",{class:"jlbinding"},"LockstepODE.PerODE")],-1)),s[17]||(s[17]=e()),a(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[19]||(s[19]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PerODE </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MemoryOrdering</span></span></code></pre></div><p>Memory layout where each ODE&#39;s state is stored contiguously.</p><p>For 2 ODEs with 3 variables each: <code>[u1_ode1, u2_ode1, u3_ode1, u1_ode2, u2_ode2, u3_ode2]</code></p><p>This is generally the best layout for most use cases.</p>',4)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[18]||(s[18]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L66-L75",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",u,[i("summary",null,[s[20]||(s[20]=i("a",{id:"LockstepODE.PerIndex",href:"#LockstepODE.PerIndex"},[i("span",{class:"jlbinding"},"LockstepODE.PerIndex")],-1)),s[21]||(s[21]=e()),a(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[23]||(s[23]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PerIndex </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MemoryOrdering</span></span></code></pre></div><p>Memory layout where same variable index is stored contiguously across ODEs.</p><p>For 2 ODEs with 3 variables each: <code>[u1_ode1, u1_ode2, u2_ode1, u2_ode2, u3_ode1, u3_ode2]</code></p><p>May provide better cache locality for operations that access the same variable across all ODEs.</p>',4)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[22]||(s[22]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L78-L88",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",b,[i("summary",null,[s[24]||(s[24]=i("a",{id:"LockstepODE.BatchedOpts",href:"#LockstepODE.BatchedOpts"},[i("span",{class:"jlbinding"},"LockstepODE.BatchedOpts")],-1)),s[25]||(s[25]=e()),a(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[27]||(s[27]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BatchedOpts{O</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MemoryOrdering</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Options for Batched mode execution.</p><p><strong>Fields</strong></p><ul><li><p><code>ordering::O</code>: Memory layout (PerODE or PerIndex)</p></li><li><p><code>internal_threading::Bool</code>: Enable CPU threading for RHS evaluation</p></li></ul>',4)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[26]||(s[26]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L95-L103",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[127]||(s[127]=i("h2",{id:"Core-Types",tabindex:"-1"},[e("Core Types "),i("a",{class:"header-anchor",href:"#Core-Types","aria-label":'Permalink to "Core Types {#Core-Types}"'},"​")],-1)),i("details",F,[i("summary",null,[s[28]||(s[28]=i("a",{id:"LockstepODE.LockstepFunction",href:"#LockstepODE.LockstepFunction"},[i("span",{class:"jlbinding"},"LockstepODE.LockstepFunction")],-1)),s[29]||(s[29]=e()),a(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[31]||(s[31]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LockstepFunction{F, C}</span></span></code></pre></div><p>Coordinates solving N independent ODEs in parallel.</p><p><strong>Fields</strong></p><ul><li><p><code>f::F</code>: ODE function with signature <code>f(du, u, p, t)</code></p></li><li><p><code>num_odes::Int</code>: Number of independent ODEs</p></li><li><p><code>ode_size::Int</code>: Size of each ODE&#39;s state vector</p></li><li><p><code>callbacks::C</code>: Per-ODE callbacks (nothing, single, or Vector)</p></li></ul><p><strong>Constructor</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, ode_size, num_odes; callbacks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> lorenz!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(du, u, p, t)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    σ, ρ, β </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> p</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    du[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    du[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ρ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    du[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> β</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lorenz!, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>`,8)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[30]||(s[30]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L117-L144",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",C,[i("summary",null,[s[32]||(s[32]=i("a",{id:"LockstepODE.LockstepProblem",href:"#LockstepODE.LockstepProblem"},[i("span",{class:"jlbinding"},"LockstepODE.LockstepProblem")],-1)),s[33]||(s[33]=e()),a(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[35]||(s[35]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LockstepProblem{M</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepMode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, LF, U, T, P, Opts}</span></span></code></pre></div><p>Problem type for batched ODE solving with mode-specific behavior.</p><p><strong>Type Parameters</strong></p><ul><li><p><code>M&lt;:LockstepMode</code>: Execution mode (Ensemble or Batched)</p></li><li><p><code>LF</code>: LockstepFunction type</p></li><li><p><code>U</code>: Initial condition element type</p></li><li><p><code>T</code>: Time type</p></li><li><p><code>P</code>: Parameter element type</p></li><li><p><code>Opts</code>: Mode-specific options type (Nothing for Ensemble, BatchedOpts for Batched)</p></li></ul><p><strong>Fields</strong></p><ul><li><p><code>lf::LF</code>: LockstepFunction coordinator</p></li><li><p><code>u0s::Vector{U}</code>: Initial conditions (one per ODE, normalized)</p></li><li><p><code>tspan::Tuple{T, T}</code>: Time span</p></li><li><p><code>ps::Vector{P}</code>: Parameters (one per ODE, normalized)</p></li><li><p><code>opts::Opts</code>: Mode-specific options</p></li></ul><p><strong>Constructors</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Default: Batched mode (best performance)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, tspan, p</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Explicit Batched mode with options</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepProblem{Batched}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, tspan, p</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; ordering</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PerODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), internal_threading</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Ensemble mode (independent timesteps per ODE)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepProblem{Ensemble}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, tspan, p</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> lorenz!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(du, u, p, t)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    σ, ρ, β </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> p</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    du[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> σ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    du[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ρ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    du[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> β</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lorenz!, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u0s </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Batched mode (default) - single batched integrator, GPU-compatible</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob_b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), p)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol_b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob_b, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Ensemble mode - N independent integrators with adaptive timesteps</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob_e </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepProblem{Ensemble}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), p)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol_e </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob_e, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div>`,10)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[34]||(s[34]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/problem.jl#L8-L61",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",m,[i("summary",null,[s[36]||(s[36]=i("a",{id:"LockstepODE.LockstepSolution",href:"#LockstepODE.LockstepSolution"},[i("span",{class:"jlbinding"},"LockstepODE.LockstepSolution")],-1)),s[37]||(s[37]=e()),a(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[39]||(s[39]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LockstepSolution{S}</span></span></code></pre></div><p>Combined solution from N independent ODEs.</p><p><strong>Fields</strong></p><ul><li><p><code>solutions::Vector{S}</code>: Individual ODESolutions (one per ODE)</p></li><li><p><code>retcode::ReturnCode.T</code>: Overall return code</p></li></ul><p><strong>Accessors</strong></p><ul><li><p><code>sol[i]</code>: Get i-th ODE&#39;s solution</p></li><li><p><code>length(sol)</code>: Number of ODEs</p></li></ul>',6)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[38]||(s[38]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/types.jl#L182-L194",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[128]||(s[128]=i("h2",{id:"Integrator-Types",tabindex:"-1"},[e("Integrator Types "),i("a",{class:"header-anchor",href:"#Integrator-Types","aria-label":'Permalink to "Integrator Types {#Integrator-Types}"'},"​")],-1)),i("details",f,[i("summary",null,[s[40]||(s[40]=i("a",{id:"LockstepODE.AbstractLockstepIntegrator",href:"#LockstepODE.AbstractLockstepIntegrator"},[i("span",{class:"jlbinding"},"LockstepODE.AbstractLockstepIntegrator")],-1)),s[41]||(s[41]=e()),a(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[43]||(s[43]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AbstractLockstepIntegrator{M}</span></span></code></pre></div><p>Abstract type for lockstep integrators, parametric on mode.</p>',2)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[42]||(s[42]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L18-L22",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",_,[i("summary",null,[s[44]||(s[44]=i("a",{id:"LockstepODE.EnsembleLockstepIntegrator",href:"#LockstepODE.EnsembleLockstepIntegrator"},[i("span",{class:"jlbinding"},"LockstepODE.EnsembleLockstepIntegrator")],-1)),s[45]||(s[45]=e()),a(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[47]||(s[47]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EnsembleLockstepIntegrator{A, I, LF, T}</span></span></code></pre></div><p>Unified integrator wrapping N individual OrdinaryDiffEq integrators. Implements CommonSolve step!/solve!/reinit! interface.</p><p><strong>Fields</strong></p><ul><li><p><code>integrators</code>: Vector of N individual ODE integrators</p></li><li><p><code>lf</code>: Reference to LockstepFunction</p></li><li><p><code>alg</code>: ODE algorithm</p></li><li><p><code>t</code>: Current lockstep time (minimum of all integrator times)</p></li><li><p><code>tspan</code>: Original time span</p></li><li><p><code>tdir</code>: Time direction (+1 or -1)</p></li><li><p><code>retcode</code>: Overall return code</p></li></ul><p><strong>Accessors</strong></p><ul><li><p><code>integ[i]</code>: Returns i-th underlying OrdinaryDiffEq integrator</p></li><li><p><code>integ.u</code>: Returns vector of current states <code>[integ[1].u, ...]</code></p></li><li><p><code>integ.t</code>: Returns current lockstep time</p></li><li><p><code>length(integ)</code>: Number of ODEs</p></li></ul>',6)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[46]||(s[46]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L32-L52",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",D,[i("summary",null,[s[48]||(s[48]=i("a",{id:"LockstepODE.BatchedLockstepIntegrator",href:"#LockstepODE.BatchedLockstepIntegrator"},[i("span",{class:"jlbinding"},"LockstepODE.BatchedLockstepIntegrator")],-1)),s[49]||(s[49]=e()),a(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[51]||(s[51]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BatchedLockstepIntegrator{I, LF, BF, Opts}</span></span></code></pre></div><p>Wrapper around a single OrdinaryDiffEq integrator with batched state. Provides uniform interface for Batched mode solving.</p><p><strong>Fields</strong></p><ul><li><p><code>integrator</code>: Single OrdinaryDiffEq integrator with batched state</p></li><li><p><code>lf</code>: Reference to LockstepFunction</p></li><li><p><code>bf</code>: BatchedFunction used for RHS evaluation</p></li><li><p><code>opts</code>: BatchedOpts configuration</p></li></ul><p><strong>Accessors</strong></p><ul><li><p><code>integ[i]</code>: Returns SubIntegrator for i-th ODE</p></li><li><p><code>integ.u</code>: Returns vector of state views <code>[view(u, idxs_1), ...]</code></p></li><li><p><code>integ.t</code>: Returns current time</p></li><li><p><code>length(integ)</code>: Number of ODEs</p></li></ul>',6)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[50]||(s[50]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L67-L84",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[129]||(s[129]=i("h2",{id:"CommonSolve-Interface",tabindex:"-1"},[e("CommonSolve Interface "),i("a",{class:"header-anchor",href:"#CommonSolve-Interface","aria-label":'Permalink to "CommonSolve Interface {#CommonSolve-Interface}"'},"​")],-1)),i("details",v,[i("summary",null,[s[52]||(s[52]=i("a",{id:"CommonSolve.init",href:"#CommonSolve.init"},[i("span",{class:"jlbinding"},"CommonSolve.init")],-1)),s[53]||(s[53]=e()),a(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[56]||(s[56]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepProblem{Ensemble}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, alg; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Initialize an EnsembleLockstepIntegrator for Ensemble mode.</p><p>Creates N independent ODE integrators that can be stepped manually or solved to completion.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepProblem{Ensemble}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), p)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Explicit Ensemble mode</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">integ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ)</span></span></code></pre></div>`,5)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[54]||(s[54]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/commonsolve.jl#L18-L33",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1}),s[57]||(s[57]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepProblem{Batched}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, alg; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Initialize a BatchedLockstepIntegrator for Batched mode.</p><p>Creates a single ODE integrator with batched state vector. RHS evaluation is parallelized across ODEs. Supports GPU arrays.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepProblem{Batched}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), p)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">integ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ)</span></span></code></pre></div>`,5)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[55]||(s[55]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/commonsolve.jl#L143-L158",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",T,[i("summary",null,[s[58]||(s[58]=i("a",{id:"CommonSolve.solve",href:"#CommonSolve.solve"},[i("span",{class:"jlbinding"},"CommonSolve.solve")],-1)),s[59]||(s[59]=e()),a(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[62]||(s[62]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepProblem{Ensemble}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, alg; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Solve the Ensemble mode problem to completion.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), p)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div>`,4)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[60]||(s[60]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/commonsolve.jl#L74-L84",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1}),s[63]||(s[63]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepProblem{Batched}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, alg; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Solve the Batched mode problem to completion.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepProblem{Batched}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), p)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div>`,4)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[61]||(s[61]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/commonsolve.jl#L200-L210",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",j,[i("summary",null,[s[64]||(s[64]=i("a",{id:"CommonSolve.solve!",href:"#CommonSolve.solve!"},[i("span",{class:"jlbinding"},"CommonSolve.solve!")],-1)),s[65]||(s[65]=e()),a(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[68]||(s[68]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">solve!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnsembleLockstepIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Solve the Ensemble integrator to completion.</p><p>Solves all N ODE integrators in parallel independently.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">integ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Optional manual stepping</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Complete the solve</span></span></code></pre></div>`,5)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[66]||(s[66]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/commonsolve.jl#L98-L111",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1}),s[69]||(s[69]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">solve!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchedLockstepIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Solve the Batched integrator to completion.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">integ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Optional manual stepping</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Complete the solve</span></span></code></pre></div>`,4)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[67]||(s[67]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/commonsolve.jl#L224-L235",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",A,[i("summary",null,[s[70]||(s[70]=i("a",{id:"CommonSolve.step!",href:"#CommonSolve.step!"},[i("span",{class:"jlbinding"},"CommonSolve.step!")],-1)),s[71]||(s[71]=e()),a(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[76]||(s[76]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnsembleLockstepIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Advance all integrators by one adaptive step. Updates <code>integ.t</code> to the minimum time across all integrators.</p><p>Note: Retcode is updated lazily via <code>update_retcode!</code> for performance. Call <code>update_retcode!(integ)</code> explicitly if immediate failure detection is needed.</p>',3)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[72]||(s[72]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L198-L206",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1}),s[77]||(s[77]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnsembleLockstepIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dt, stop_at_tdt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Advance all integrators by time <code>dt</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>dt</code>: Time increment</p></li><li><p><code>stop_at_tdt</code>: If <code>true</code>, step exactly to <code>t + dt</code>. If <code>false</code>, step may overshoot.</p></li></ul><p>Note: Retcode is updated lazily via <code>update_retcode!</code> for performance.</p>',5)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[73]||(s[73]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L218-L228",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1}),s[78]||(s[78]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchedLockstepIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Advance the batched integrator by one step.</p>',2)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[74]||(s[74]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L266-L270",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1}),s[79]||(s[79]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchedLockstepIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dt, stop_at_tdt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Advance the batched integrator by time <code>dt</code>.</p>',2)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[75]||(s[75]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L276-L280",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",B,[i("summary",null,[s[80]||(s[80]=i("a",{id:"SciMLBase.reinit!",href:"#SciMLBase.reinit!"},[i("span",{class:"jlbinding"},"SciMLBase.reinit!")],-1)),s[81]||(s[81]=e()),a(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[84]||(s[84]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reinit!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnsembleLockstepIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, u0s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; t0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, tf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, erase_sol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Reinitialize the Ensemble integrator, optionally with new initial conditions.</p><p><strong>Arguments</strong></p><ul><li><p><code>u0s</code>: New initial conditions (vector of vectors, single vector, or <code>nothing</code> to keep current)</p></li><li><p><code>t0</code>: New initial time (default: original t0)</p></li><li><p><code>tf</code>: New final time (default: original tf)</p></li><li><p><code>erase_sol</code>: Whether to erase accumulated solution data</p></li></ul>',4)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[82]||(s[82]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L290-L300",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1}),s[85]||(s[85]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reinit!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(integ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchedLockstepIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, u0s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; t0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, tf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, erase_sol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Reinitialize the Batched integrator, optionally with new initial conditions.</p><p><strong>Arguments</strong></p><ul><li><p><code>u0s</code>: New initial conditions (vector of vectors, single vector, or <code>nothing</code> to keep current)</p></li><li><p><code>t0</code>: New initial time (default: original t0)</p></li><li><p><code>tf</code>: New final time (default: original tf)</p></li><li><p><code>erase_sol</code>: Whether to erase accumulated solution data</p></li></ul>',4)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[83]||(s[83]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/integrator.jl#L344-L354",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[130]||(s[130]=i("h2",{id:"Solution-Utilities",tabindex:"-1"},[e("Solution Utilities "),i("a",{class:"header-anchor",href:"#Solution-Utilities","aria-label":'Permalink to "Solution Utilities {#Solution-Utilities}"'},"​")],-1)),i("details",L,[i("summary",null,[s[86]||(s[86]=i("a",{id:"LockstepODE.extract_solutions",href:"#LockstepODE.extract_solutions"},[i("span",{class:"jlbinding"},"LockstepODE.extract_solutions")],-1)),s[87]||(s[87]=e()),a(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[89]||(s[89]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">extract_solutions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, sol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepSolution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Extract individual ODE solutions as a vector.</p><p>This is a convenience function for compatibility with the v1 API. With LockstepSolution, you can also just use <code>sol.solutions</code> or iterate directly.</p><p><strong>Returns</strong></p><p>Vector of individual ODESolution objects.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f!, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, u0s, tspan, p)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">individual_sols </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> extract_solutions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, sol)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (i, s) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(individual_sols)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ODE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> final state: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$(s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">u[end])</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div>`,7)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[88]||(s[88]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/solution.jl#L170-L192",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",O,[i("summary",null,[s[90]||(s[90]=i("a",{id:"LockstepODE.extract_at_time",href:"#LockstepODE.extract_at_time"},[i("span",{class:"jlbinding"},"LockstepODE.extract_at_time")],-1)),s[91]||(s[91]=e()),a(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[93]||(s[93]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">extract_at_time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LockstepSolution</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Real</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Extract all ODE states at a specific time (with interpolation).</p><p><strong>Returns</strong></p><p>Vector of state vectors, one per ODE.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states_at_5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> extract_at_time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sol, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (i, state) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(states_at_5)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ODE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> at t=5: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div>`,6)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[92]||(s[92]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/solution.jl#L197-L212",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[131]||(s[131]=i("h2",{id:"Batched-Mode-Internals",tabindex:"-1"},[e("Batched Mode Internals "),i("a",{class:"header-anchor",href:"#Batched-Mode-Internals","aria-label":'Permalink to "Batched Mode Internals {#Batched-Mode-Internals}"'},"​")],-1)),i("details",S,[i("summary",null,[s[94]||(s[94]=i("a",{id:"LockstepODE.BatchedFunction",href:"#LockstepODE.BatchedFunction"},[i("span",{class:"jlbinding"},"LockstepODE.BatchedFunction")],-1)),s[95]||(s[95]=e()),a(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[97]||(s[97]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BatchedFunction{O</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MemoryOrdering</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, F, C}</span></span></code></pre></div><p>Callable wrapper for batched ODE solving with a LockstepFunction.</p><p>Wraps a LockstepFunction with batched-specific options (memory ordering, threading) and provides the callable interface <code>(du, u, p, t)</code> for OrdinaryDiffEq.jl.</p><p><strong>Fields</strong></p><ul><li><p><code>lf::LockstepFunction{F,C}</code>: The underlying LockstepFunction</p></li><li><p><code>ordering::O</code>: Memory layout (PerODE or PerIndex)</p></li><li><p><code>internal_threading::Bool</code>: Enable CPU threading for RHS evaluation</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lorenz!, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> BatchedFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lf, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PerODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Now bf can be used with ODEProblem</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u0_batched </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> vcat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ODEProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bf, u0_batched, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), p)</span></span></code></pre></div>`,7)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[96]||(s[96]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/batched.jl#L14-L36",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",x,[i("summary",null,[s[98]||(s[98]=i("a",{id:"LockstepODE.SubIntegrator",href:"#LockstepODE.SubIntegrator"},[i("span",{class:"jlbinding"},"LockstepODE.SubIntegrator")],-1)),s[99]||(s[99]=e()),a(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[101]||(s[101]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SubIntegrator{I, BF, U, P}</span></span></code></pre></div><p>Lightweight wrapper providing a per-ODE view of the batched integrator state.</p><p>Used by the callback system to give per-ODE callbacks access to only their ODE&#39;s state while maintaining the ability to modify the full integrator.</p><p><strong>Fields</strong></p><ul><li><p><code>parent::I</code>: The full OrdinaryDiffEq integrator</p></li><li><p><code>bf::BF</code>: The BatchedFunction containing metadata</p></li><li><p><code>ode_idx::Int</code>: Index of the ODE this sub-integrator represents</p></li><li><p><code>u::U</code>: View of the state for this ODE only</p></li><li><p><code>p::P</code>: Parameters for this ODE</p></li></ul>',5)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[100]||(s[100]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/batched.jl#L151-L165",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",I,[i("summary",null,[s[102]||(s[102]=i("a",{id:"LockstepODE.BatchedSubSolution",href:"#LockstepODE.BatchedSubSolution"},[i("span",{class:"jlbinding"},"LockstepODE.BatchedSubSolution")],-1)),s[103]||(s[103]=e()),a(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[105]||(s[105]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BatchedSubSolution{S, BF}</span></span></code></pre></div><p>Wrapper providing per-ODE solution access with interpolation for Batched mode.</p><p>When <code>sol = solve(prob, alg)</code> is called in Batched mode, <code>sol[i]</code> returns a <code>BatchedSubSolution</code> that provides:</p><ul><li><p><code>sol[i](t)</code>: Interpolate state at time <code>t</code></p></li><li><p><code>sol[i].u</code>: Time series of states (cached on first access)</p></li><li><p><code>sol[i].t</code>: Time points</p></li></ul><p><strong>Fields</strong></p><ul><li><p><code>parent::S</code>: The full batched ODESolution</p></li><li><p><code>bf::BF</code>: BatchedFunction for index calculations</p></li><li><p><code>ode_idx::Int</code>: Which ODE this represents</p></li><li><p><code>_u_cache::Vector</code>: Cached time series (populated on first .u access)</p></li></ul>',6)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[104]||(s[104]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/solution.jl#L12-L28",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",P,[i("summary",null,[s[106]||(s[106]=i("a",{id:"LockstepODE._get_idxs",href:"#LockstepODE._get_idxs"},[i("span",{class:"jlbinding"},"LockstepODE._get_idxs")],-1)),s[107]||(s[107]=e()),a(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[109]||(s[109]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">_get_idxs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchedFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UnitRange</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">StepRange</span></span></code></pre></div><p>Get the indices for the i-th ODE&#39;s state in the batched state vector.</p><p>Dispatches on memory ordering:</p><ul><li><p>PerODE: Returns contiguous range <code>((i-1)*M+1):(i*M)</code></p></li><li><p>PerIndex: Returns strided range <code>i:N:((M-1)*N+i)</code></p></li></ul>',4)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[108]||(s[108]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/batched.jl#L66-L74",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",V,[i("summary",null,[s[110]||(s[110]=i("a",{id:"LockstepODE.ode_kernel!",href:"#LockstepODE.ode_kernel!"},[i("span",{class:"jlbinding"},"LockstepODE.ode_kernel!")],-1)),s[111]||(s[111]=e()),a(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[113]||(s[113]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ode_kernel!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i, bf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchedFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, du, u, p, t)</span></span></code></pre></div><p>Evaluate the i-th ODE&#39;s RHS within the batched system.</p><p>This is the core kernel called for each ODE in the batch. Marked <code>@inline</code> for use in GPU extensions via KernelAbstractions.jl.</p>',3)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[112]||(s[112]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/batched.jl#L108-L115",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",R,[i("summary",null,[s[114]||(s[114]=i("a",{id:"LockstepODE.create_lockstep_callbacks",href:"#LockstepODE.create_lockstep_callbacks"},[i("span",{class:"jlbinding"},"LockstepODE.create_lockstep_callbacks")],-1)),s[115]||(s[115]=e()),a(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[117]||(s[117]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">create_lockstep_callbacks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchedFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Create wrapped callbacks for batched ODE solving.</p><p>Takes a BatchedFunction with per-ODE callbacks stored in its LockstepFunction and returns callbacks that dispatch to SubIntegrators for each ODE.</p><p>Returns <code>nothing</code> if no callbacks are stored.</p>',4)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[116]||(s[116]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/batched.jl#L205-L214",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",N,[i("summary",null,[s[118]||(s[118]=i("a",{id:"LockstepODE.batch_u0s",href:"#LockstepODE.batch_u0s"},[i("span",{class:"jlbinding"},"LockstepODE.batch_u0s")],-1)),s[119]||(s[119]=e()),a(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[122]||(s[122]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">batch_u0s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u0s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vector{&lt;:AbstractVector}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PerODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Concatenate per-ODE initial conditions into PerODE layout. Layout: [u1_ode1, u2_ode1, ..., u1_ode2, u2_ode2, ...]</p>',2)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[120]||(s[120]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/batched.jl#L281-L286",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1}),s[123]||(s[123]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">batch_u0s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u0s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vector{&lt;:AbstractVector}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PerIndex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Concatenate per-ODE initial conditions into PerIndex layout. Layout: [u1_ode1, u1_ode2, ..., u2_ode1, u2_ode2, ...]</p>',2)),a(t,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[121]||(s[121]=[i("a",{href:"https://github.com/kylebeggs/LockstepODE.jl/blob/842fb4ce90f19cea047169030391bc024a205e2d/src/batched.jl#L291-L296",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})])])}const H=p(r,[["render",w]]);export{G as __pageData,H as default};
