import{_ as i,c as a,o as n,aA as e}from"./chunks/framework.1niJ8HWr.js";const c=JSON.parse('{"title":"","description":"","frontmatter":{"layout":"home","hero":{"name":"LockstepODE.jl Docs","tagline":"Stepping Through ODEs in Lockstep"}},"headers":[],"relativePath":"index.md","filePath":"index.md","lastUpdated":null}'),t={name:"index.md"};function l(p,s,h,r,o,k){return n(),a("div",null,[...s[0]||(s[0]=[e(`<h2 id="Overview" tabindex="-1">Overview <a class="header-anchor" href="#Overview" aria-label="Permalink to &quot;Overview {#Overview}&quot;">​</a></h2><p>LockstepODE.jl is a Julia package for solving multiple ordinary differential equations (ODEs) in lockstep - meaning they share the same timestepping and are synchronized through time. It provides a high-level interface for batching multiple ODE systems into a single solve, with support for CPU threading and GPU acceleration, different memory layouts, and per-ODE callbacks.</p><h2 id="Features" tabindex="-1">Features <a class="header-anchor" href="#Features" aria-label="Permalink to &quot;Features {#Features}&quot;">​</a></h2><ul><li><p><strong>CPU Threading</strong>: Automatic CPU parallelization across ODE systems using <code>OhMyThreads.jl</code></p></li><li><p><strong>GPU Acceleration</strong>: Automatic GPU support via KernelAbstractions.jl for CUDA (NVIDIA), AMDGPU (AMD), Metal (Apple), and oneAPI (Intel)</p></li><li><p><strong>Callbacks</strong>: Apply different callbacks to each ODE system or share callbacks across all systems</p></li><li><p><strong>Flexible memory layouts</strong>: Support for both per-ODE (<code>PerODE</code>) and per-index (<code>PerIndex</code>) data organization</p></li><li><p><strong>Standard workflow</strong>: Uses standard <code>OrdinaryDiffEq.jl</code> workflow with <code>ODEProblem</code> and <code>solve</code></p></li><li><p><strong>Utility functions</strong>: Built-in functions for batching initial conditions and extracting solutions</p></li></ul><h2 id="Installation" tabindex="-1">Installation <a class="header-anchor" href="#Installation" aria-label="Permalink to &quot;Installation {#Installation}&quot;">​</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Pkg</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Pkg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;LockstepODE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Or from the Julia REPL:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] add LockstepODE</span></span></code></pre></div><h2 id="Quick-Start" tabindex="-1">Quick Start <a class="header-anchor" href="#Quick-Start" aria-label="Permalink to &quot;Quick Start {#Quick-Start}&quot;">​</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LockstepODE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OrdinaryDiffEq</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Define a simple harmonic oscillator</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> harmonic_oscillator!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(du, u, p, t)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    du[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># dx/dt = v</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    du[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># dv/dt = -x</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create a lockstep function for 3 oscillators</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">num_odes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u0_single </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Single initial condition</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u0_batched </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> repeat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u0_single, num_odes)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Batch for all oscillators</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lockstep_func </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> LockstepFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(harmonic_oscillator!, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u0_single), num_odes)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use standard OrdinaryDiffEq.jl workflow</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ODEProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lockstep_func, u0_batched, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2π</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Extract individual solutions</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">individual_sols </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> extract_solutions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lockstep_func, sol)</span></span></code></pre></div><h2 id="GPU-Acceleration" tabindex="-1">GPU Acceleration <a class="header-anchor" href="#GPU-Acceleration" aria-label="Permalink to &quot;GPU Acceleration {#GPU-Acceleration}&quot;">​</a></h2><p>LockstepODE.jl automatically detects and uses GPU arrays when available. Simply load your preferred GPU backend and convert your arrays:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LockstepODE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CUDA  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Or: AMDGPU, Metal, oneAPI</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Everything else stays the same - just use GPU arrays</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u0_batched </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CuArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u0_batched)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Move to GPU</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ODEProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lockstep_func, u0_batched, tspan, p)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tsit5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Automatically runs on GPU</span></span></code></pre></div><p>Supported backends:</p><ul><li><p><strong>CUDA.jl</strong>: NVIDIA GPUs</p></li><li><p><strong>AMDGPU.jl</strong>: AMD GPUs (ROCm)</p></li><li><p><strong>Metal.jl</strong>: Apple Silicon GPUs</p></li><li><p><strong>oneAPI.jl</strong>: Intel GPUs</p></li></ul><p>All backends are optional - only install what you need. No code changes required; backend selection is automatic based on array type.</p><h2 id="Key-Features-Explained" tabindex="-1">Key Features Explained <a class="header-anchor" href="#Key-Features-Explained" aria-label="Permalink to &quot;Key Features Explained {#Key-Features-Explained}&quot;">​</a></h2><h3 id="Multiple-Initial-Conditions" tabindex="-1">Multiple Initial Conditions <a class="header-anchor" href="#Multiple-Initial-Conditions" aria-label="Permalink to &quot;Multiple Initial Conditions {#Multiple-Initial-Conditions}&quot;">​</a></h3><p>Solve the same ODE system with different starting points simultaneously. LockstepODE batches your initial conditions and parameters into a single efficient solve, then extracts individual solutions. Perfect for parameter sweeps, ensemble simulations, or Monte Carlo methods.</p><p>See the <a href="./examples/basic_usage">Basic Usage</a> example for detailed implementation.</p><h3 id="Callbacks" tabindex="-1">Callbacks <a class="header-anchor" href="#Callbacks" aria-label="Permalink to &quot;Callbacks {#Callbacks}&quot;">​</a></h3><p>Apply different callbacks to each ODE in your batch. Each ODE can have its own event detection and handling logic while still being solved efficiently in parallel. Supports both <code>DiscreteCallback</code> and <code>ContinuousCallback</code> from OrdinaryDiffEq.jl.</p><p>Example use cases:</p><ul><li><p>Different reset thresholds per simulation</p></li><li><p>Heterogeneous stopping conditions</p></li><li><p>Per-instance event logging</p></li></ul><p>See the <a href="./examples/callbacks">Callbacks</a> example for comprehensive examples.</p><h3 id="Memory-Layouts" tabindex="-1">Memory Layouts <a class="header-anchor" href="#Memory-Layouts" aria-label="Permalink to &quot;Memory Layouts {#Memory-Layouts}&quot;">​</a></h3><p>Choose between two memory layouts optimized for different access patterns:</p><ul><li><p><strong>PerODE</strong> (default): Each ODE&#39;s variables stored contiguously - best for most use cases</p></li><li><p><strong>PerIndex</strong>: Same variable across ODEs stored contiguously - can improve cache locality for certain operations</p></li></ul><h3 id="Threading-Control" tabindex="-1">Threading Control <a class="header-anchor" href="#Threading-Control" aria-label="Permalink to &quot;Threading Control {#Threading-Control}&quot;">​</a></h3><p>CPU parallelization across ODE systems using <code>OhMyThreads.jl</code>, with automatic GPU acceleration when GPU arrays are used. Control threading behavior with <code>internal_threading</code> parameter for integration with external parallel workflows or debugging.</p><h3 id="Utility-Functions" tabindex="-1">Utility Functions <a class="header-anchor" href="#Utility-Functions" aria-label="Permalink to &quot;Utility Functions {#Utility-Functions}&quot;">​</a></h3><p>Built-in functions for common operations:</p><ul><li><p><code>batch_initial_conditions</code>: Prepare initial conditions for batched solving</p></li><li><p><code>extract_solutions</code>: Separate batched solution into individual ODESolution objects</p></li><li><p><code>create_lockstep_callbacks</code>: Wrap callbacks for batched execution (usually automatic)</p></li></ul><p>See the <a href="./examples/advanced_configuration">Advanced Configuration</a> example for performance tuning and threading control.</p>`,34)])])}const E=i(t,[["render",l]]);export{c as __pageData,E as default};
